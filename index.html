<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EA License Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            flex: 1;
            min-width: 150px;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .tab:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .tab.active {
            background: white;
            color: #667eea;
            font-weight: bold;
        }
        
        .content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .result-box {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .license-key {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            margin: 10px 0;
            letter-spacing: 2px;
            font-family: 'Courier New', monospace;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .info-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
        }
        
        .info-item label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .info-item .value {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }
        
        .table tr:hover {
            background: #f8f9fa;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        
        .status-expired {
            background: #f8d7da;
            color: #721c24;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        
        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        
        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }
        
        .code-box {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin-top: 10px;
        }
        
        .copy-btn {
            float: right;
            padding: 5px 15px;
            font-size: 12px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .stat-card p {
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê EA License Management System</h1>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ License Key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Expert Advisor</p>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('generator')">üé´ ‡∏™‡∏£‡πâ‡∏≤‡∏á License</button>
            <button class="tab" onclick="showTab('validator')">‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö License</button>
            <button class="tab" onclick="showTab('manager')">üìä ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ License</button>
            <button class="tab" onclick="showTab('code')">üíª ‡πÇ‡∏Ñ‡πâ‡∏î MQL4</button>
        </div>
        
        <div class="content">
            <!-- Tab 1: License Generator -->
            <div id="generator" class="tab-content active">
                <h2>üé´ ‡∏™‡∏£‡πâ‡∏≤‡∏á License Key ‡πÉ‡∏´‡∏°‡πà</h2>
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á License Key ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
                </div>
                
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
                    <input type="text" id="customerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                </div>
                
                <div class="form-group">
                    <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Trading (Account Number)</label>
                    <input type="number" id="accountNumber" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12345678">
                </div>
                
                <div class="form-group">
                    <label>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
                    <select id="validPeriod">
                        <option value="30">30 ‡∏ß‡∏±‡∏ô (1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</option>
                        <option value="90">90 ‡∏ß‡∏±‡∏ô (3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</option>
                        <option value="180">180 ‡∏ß‡∏±‡∏ô (6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</option>
                        <option value="365" selected>365 ‡∏ß‡∏±‡∏ô (1 ‡∏õ‡∏µ)</option>
                        <option value="730">730 ‡∏ß‡∏±‡∏ô (2 ‡∏õ‡∏µ)</option>
                        <option value="custom">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</option>
                    </select>
                </div>
                
                <div class="form-group" id="customDaysGroup" style="display:none;">
                    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
                    <input type="number" id="customDays" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô">
                </div>
                
                <button class="btn btn-primary" onclick="generateLicense()">üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á License Key</button>
                
                <div id="generatorResult"></div>
            </div>
            
            <!-- Tab 2: License Validator -->
            <div id="validator" class="tab-content">
                <h2>‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö License Key</h2>
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡πÉ‡∏™‡πà License Key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
                </div>
                
                <div class="form-group">
                    <label>License Key</label>
                    <input type="text" id="validateLicense" placeholder="XXXX-XXXX-XXXX-XXXX">
                </div>
                
                <div class="form-group">
                    <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Trading</label>
                    <input type="number" id="validateAccount" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12345678">
                </div>
                
                <button class="btn btn-primary" onclick="validateLicense()">üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
                
                <div id="validatorResult"></div>
            </div>
            
            <!-- Tab 3: License Manager -->
            <div id="manager" class="tab-content">
                <h2>üìä ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ License ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                
                <div class="stats">
                    <div class="stat-card">
                        <h3 id="totalLicenses">0</h3>
                        <p>License ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="activeLicenses">0</h3>
                        <p>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="expiredLicenses">0</h3>
                        <p>‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß</p>
                    </div>
                </div>
                
                <button class="btn btn-secondary" onclick="exportLicenses()">üì• Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                <button class="btn btn-danger" onclick="clearAllLicenses()">üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                            <th>Account</th>
                            <th>License Key</th>
                            <th>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠</th>
                            <th>‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="licenseTable">
                        <tr>
                            <td colspan="7" style="text-align:center; color:#999;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ License ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Tab 4: MQL4 Code -->
            <div id="code" class="tab-content">
                <h2>üíª ‡πÇ‡∏Ñ‡πâ‡∏î MQL4 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö EA</h2>
                
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:</strong> Copy ‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô EA ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                </div>
                
                <h3>1. ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö License</h3>
                <button class="copy-btn btn btn-secondary" onclick="copyCode('mql4Code1')">üìã Copy</button>
                <div class="code-box" id="mql4Code1">// ‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡πÉ‡∏ô EA ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

input string USER_LICENSE_KEY = "";  // ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å License Key ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà

// Secret Key (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á!)
string SECRET_KEY = "MySecretKey2024!@#";

bool ValidateLicense()
{
    long account = AccountInfoInteger(ACCOUNT_LOGIN);
    string license = USER_LICENSE_KEY;
    
    // ‡∏•‡∏ö dash
    StringReplace(license, "-", "");
    
    if(StringLen(license) != 16)
    {
        Alert("License Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return false;
    }
    
    // ‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô
    string part1 = StringSubstr(license, 0, 4);
    string part2 = StringSubstr(license, 4, 4);
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Account
    long acc = StringToInteger(part1);
    if(acc != account % 10000)
    {
        Alert("License ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Account ‡∏ô‡∏µ‡πâ");
        return false;
    }
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Hash
    string rawData = IntegerToString(account) + part2 + SECRET_KEY;
    int hash = SimpleHash(rawData);
    
    string hashCheck = IntegerToString((hash >> 16) & 0xFFFF, 4, '0') + 
                       IntegerToString(hash & 0xFFFF, 4, '0');
    
    if(StringSubstr(license, 8, 8) != hashCheck)
    {
        Alert("License Key ‡∏õ‡∏•‡∏≠‡∏°");
        return false;
    }
    
    Print("‚úÖ License ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
    return true;
}

int SimpleHash(string str)
{
    int hash = 5381;
    for(int i = 0; i < StringLen(str); i++)
    {
        hash = ((hash << 5) + hash) + StringGetCharacter(str, i);
    }
    return MathAbs(hash);
}

int OnInit()
{
    if(!ValidateLicense())
    {
        Alert("‚õî ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà License Key ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return INIT_FAILED;
    }
    
    return INIT_SUCCEEDED;
}</div>

                <h3>2. ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</h3>
                <button class="copy-btn btn btn-secondary" onclick="copyCode('mql4Code2')">üìã Copy</button>
                <div class="code-box" id="mql4Code2">// ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏

bool CheckExpiry(string license)
{
    StringReplace(license, "-", "");
    string expiryPart = StringSubstr(license, 4, 4);
    long expiryMod = StringToInteger(expiryPart);
    
    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
    datetime now = TimeCurrent();
    int year = TimeYear(now);
    
    for(int y = year; y <= year + 3; y++)
    {
        for(int m = 1; m <= 12; m++)
        {
            datetime testDate = StringToTime(
                IntegerToString(y) + "." + 
                IntegerToString(m) + ".01"
            );
            
            if(testDate % 10000 == expiryMod)
            {
                if(now > testDate)
                {
                    Alert("‚õî License ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß");
                    return false;
                }
                
                int daysLeft = (int)((testDate - now) / 86400);
                if(daysLeft <= 7)
                {
                    Alert("‚ö†Ô∏è License ‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô‡∏≠‡∏µ‡∏Å ", daysLeft, " ‡∏ß‡∏±‡∏ô");
                }
                
                return true;
            }
        }
    }
    
    return true;
}</div>
            </div>
        </div>
    </div>

    <script>
        const SECRET_KEY = "MySecretKey2024!@#";
        let licenses = JSON.parse(localStorage.getItem('licenses') || '[]');
        
        // ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô custom days
        document.getElementById('validPeriod').addEventListener('change', function(e) {
            const customGroup = document.getElementById('customDaysGroup');
            customGroup.style.display = e.target.value === 'custom' ? 'block' : 'none';
        });
        
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if(tabName === 'manager') {
                updateLicenseTable();
            }
        }
        
        function simpleHash(str) {
            let hash = 5381;
            for(let i = 0; i < str.length; i++) {
                hash = ((hash << 5) + hash) + str.charCodeAt(i);
            }
            return Math.abs(hash);
        }
        
        function generateLicense() {
            const name = document.getElementById('customerName').value;
            const account = document.getElementById('accountNumber').value;
            const period = document.getElementById('validPeriod').value;
            
            if(!name || !account) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }
            
            let days = period === 'custom' ? 
                      parseInt(document.getElementById('customDays').value) : 
                      parseInt(period);
            
            if(!days || days <= 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                return;
            }
            
            const now = new Date();
            const expiry = new Date(now.getTime() + days * 24 * 60 * 60 * 1000);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á License Key
            const part1 = (parseInt(account) % 10000).toString().padStart(4, '0');
            const part2 = (expiry.getTime() % 10000).toString().padStart(4, '0');
            
            const rawData = account + part2 + SECRET_KEY;
            const hash = simpleHash(rawData);
            
            const part3 = ((hash >> 16) & 0xFFFF).toString().padStart(4, '0');
            const part4 = (hash & 0xFFFF).toString().padStart(4, '0');
            
            const license = `${part1}-${part2}-${part3}-${part4}`;
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            const licenseData = {
                id: Date.now(),
                customer: name,
                account: account,
                license: license,
                created: now.toISOString(),
                expiry: expiry.toISOString(),
                days: days
            };
            
            licenses.push(licenseData);
            localStorage.setItem('licenses', JSON.stringify(licenses));
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            const result = `
                <div class="result-box">
                    <div class="alert alert-success">
                        <strong>‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á License Key ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</strong>
                    </div>
                    <div class="license-key">${license}</div>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
                            <div class="value">${name}</div>
                        </div>
                        <div class="info-item">
                            <label>Account Number</label>
                            <div class="value">${account}</div>
                        </div>
                        <div class="info-item">
                            <label>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</label>
                            <div class="value">${days} ‡∏ß‡∏±‡∏ô</div>
                        </div>
                        <div class="info-item">
                            <label>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</label>
                            <div class="value">${expiry.toLocaleDateString('th-TH')}</div>
                        </div>
                    </div>
                    <div style="margin-top:20px;">
                        <button class="btn btn-secondary" onclick="copyLicense('${license}')">üìã Copy License Key</button>
                    </div>
                </div>
            `;
            
            document.getElementById('generatorResult').innerHTML = result;
        }
        
        function validateLicense() {
            const license = document.getElementById('validateLicense').value;
            const account = document.getElementById('validateAccount').value;
            
            if(!license || !account) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }
            
            const cleanLicense = license.replace(/-/g, '');
            
            if(cleanLicense.length !== 16) {
                showValidationResult(false, 'License Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á');
                return;
            }
            
            const part1 = cleanLicense.substr(0, 4);
            const part2 = cleanLicense.substr(4, 4);
            const part3 = cleanLicense.substr(8, 4);
            const part4 = cleanLicense.substr(12, 4);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Account
            const accCheck = parseInt(account) % 10000;
            if(parseInt(part1) !== accCheck) {
                showValidationResult(false, 'License Key ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Account ‡∏ô‡∏µ‡πâ');
                return;
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Hash
            const rawData = account + part2 + SECRET_KEY;
            const hash = simpleHash(rawData);
            const hashCheck = ((hash >> 16) & 0xFFFF).toString().padStart(4, '0') + 
                            (hash & 0xFFFF).toString().padStart(4, '0');
            
            if(part3 + part4 !== hashCheck) {
                showValidationResult(false, 'License Key ‡∏õ‡∏•‡∏≠‡∏°');
                return;
            }
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£)
            const expiryMod = parseInt(part2);
            const now = new Date();
            let expiryDate = null;
            
            for(let year = now.getFullYear(); year <= now.getFullYear() + 3; year++) {
                for(let month = 0; month < 12; month++) {
                    const testDate = new Date(year, month, 1);
                    if(testDate.getTime() % 10000 === expiryMod) {
                        expiryDate = testDate;
                        break;
                    }
                }
                if(expiryDate) break;
            }
            
            if(expiryDate && now > expiryDate) {
                showValidationResult(false, 'License Key ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß', expiryDate);
                return;
            }
            
            showValidationResult(true, 'License Key ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', expiryDate);
        }
        
        function showValidationResult(valid, message, expiryDate = null) {
            const alertClass = valid ? 'alert-success' : 'alert-danger';
            const icon = valid ? '‚úÖ' : '‚ùå';
            
            let expiryInfo = '';
            if(expiryDate && valid) {
                const daysLeft = Math.floor((expiryDate - new Date()) / (24 * 60 * 60 * 1000));
                expiryInfo = `
                    <div class="info-grid" style="margin-top:15px;">
                        <div class="info-item">
                            <label>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</label>
                            <div class="value">${expiryDate.toLocaleDateString('th-TH')}</div>
                        </div>
                        <div class="info-item">
                            <label>‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤</label>
                            <div class="value">${daysLeft} ‡∏ß‡∏±‡∏ô</div>
                        </div>
                    </div>
                `;
            }
            
            const result = `
                <div class="result-box">
                    <div class="alert ${alertClass}">
                        <strong>${icon} ${message}</strong>
                    </div>
                    ${expiryInfo}
                </div>
            `;
            
            document.getElementById('validatorResult').innerHTML = result;
        }
        
        function updateLicenseTable() {
            const tbody = document.getElementById('licenseTable');
            const now = new Date();
            
            if(licenses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; color:#999;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ License ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</td></tr>';
                document.getElementById('totalLicenses').textContent = '0';
                document.getElementById('activeLicenses').textContent = '0';
                document.getElementById('expiredLicenses').textContent = '0';
                return;
            }
            
            let activeCount = 0;
            let expiredCount = 0;
            
            const rows = licenses.map((lic, idx) => {
                const expiry = new Date(lic.expiry);
                const isExpired = now > expiry;
                
                if(isExpired) expiredCount++;
                else activeCount++;
                
                const statusBadge = isExpired ? 
                    '<span class="status-badge status-expired">‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</span>' :
                    '<span class="status-badge status-active">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</span>';
                
                return `
                    <tr>
                        <td>${lic.customer}</td>
                        <td>${lic.account}</td>
                        <td><code>${lic.license}</code></td>
                        <td>${new Date(lic.created).toLocaleDateString('th-TH')}</td>
                        <td>${expiry.toLocaleDateString('th-TH')}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-danger" style="padding:5px 10px; font-size:12px;" onclick="deleteLicense(${idx})">‡∏•‡∏ö</button>
                        </td>
                    </tr>
                `;
            }).join('');
            
            tbody.innerHTML = rows;
            
            document.getElementById('totalLicenses').textContent = licenses.length;
            document.getElementById('activeLicenses').textContent = activeCount;
            document.getElementById('expiredLicenses').textContent = expiredCount;
        }
        
        function deleteLicense(index) {
            if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö License ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                licenses.splice(index, 1);
                localStorage.setItem('licenses', JSON.stringify(licenses));
                updateLicenseTable();
            }
        }
        
        function clearAllLicenses() {
            if(confirm('‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö License ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ!')) {
                if(confirm('‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£!')) {
                    licenses = [];
                    localStorage.removeItem('licenses');
                    updateLicenseTable();
                    alert('‚úÖ ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
                }
            }
        }
        
        function exportLicenses() {
            if(licenses.length === 0) {
                alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export');
                return;
            }
            
            let csv = '‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤,Account Number,License Key,‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á,‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô\n';
            
            licenses.forEach(lic => {
                const created = new Date(lic.created).toLocaleDateString('th-TH');
                const expiry = new Date(lic.expiry).toLocaleDateString('th-TH');
                csv += `"${lic.customer}","${lic.account}","${lic.license}","${created}","${expiry}","${lic.days}"\n`;
            });
            
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `licenses_${new Date().getTime()}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('‚úÖ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
        }
        
        function copyLicense(license) {
            navigator.clipboard.writeText(license).then(() => {
                alert('‚úÖ Copy License Key ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢: ' + license);
            }).catch(() => {
                // Fallback method
                const textArea = document.createElement('textarea');
                textArea.value = license;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('‚úÖ Copy License Key ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢: ' + license);
            });
        }
        
        function copyCode(elementId) {
            const codeElement = document.getElementById(elementId);
            const code = codeElement.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                alert('‚úÖ Copy ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = code;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('‚úÖ Copy ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
            });
        }
        
        // Load data on page load
        window.addEventListener('load', () => {
            updateLicenseTable();
        });
    </script>
</body>
</html>
